package rules;
import ftn.bsep.siemcenter.model.Log;
global java.util.List logsOutput;

rule "ERROR-log"
    when
        $log: Log( getLevel() == 'ERROR');
    then
    	logsOutput.add("ERROR has occured");
    	delete($log);
end 
 


rule "LOG_ALWAYS-log"
    when
        $log: Log( getLevel() == 'LOG_ALWAYS' );
    then
    	logsOutput.add("Log_Always has occured");
    	delete($log);
end 
 
rule "CRITICAL-log"
	when
	    $log: Log( getLevel() == 'CRITICAL' );
	then
		logsOutput.add("Critical log has occured.");
		delete($log);
end 

rule "Special privileges - log on"
	when
	    $log: Log( getEventId() == '4672');
	then
		logsOutput.add("Special privileges - log on");
		delete($log);
end 
 

rule "ERROR-login"
	when
	    $log: Log( getEventId() == '4625', $eventId: eventId );
	    Number(intValue >= 2) from accumulate(
        $log2: Log( this != $log, eventId == $eventId, this meets[15s] $log),count($log2))
	then
		logsOutput.add("Multiple failed login! Time: " + $log.getTimestamp());
		delete($log);
end 
 
rule "WARNING-log"
	when
	    $log: Log( getLevel() == 'WARNING' );
	then
		logsOutput.add("Warning log has occured. Time: " + $log.getTimestamp() + "| On machine: " + $log.getComputerName() + "Message: " + $log.getMessage());
		delete($log);
end 
 
rule "INFORMATIONAL-log"
	when
	    $log: Log( getLevel() == 'INFORMATIONAL' );
	then
		logsOutput.add("Informational log has occured. Time: " + $log.getTimestamp() + "| On machine: " + $log.getComputerName() + "Message: " + $log.getMessage());
		delete($log);
end
 
rule "VERBOSE-log"
	when
	    $log: Log( getLevel() == 'VERBOSE' );
	then
		logsOutput.add("Verbose log has occured. Time: " + $log.getTimestamp() + "| On machine: " + $log.getComputerName() + "Message: " + $log.getMessage());
		delete($log);
end 
 

